
Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
OK
Time taken: 9.413 seconds
16/12/20 08:02:04 ERROR calcite.RelOptHiveTable: No Stats for dbmarketing@cge_campaign_audience, Columns: campaign_id
16/12/20 08:02:04 ERROR parse.CalcitePlanner: CBO failed due to missing column stats (see previous errors), skipping CBO
Query ID = hdp_oc_team_20161220080151_81d33481-d4f6-4132-a9c2-b8ff7ffb526d
Total jobs = 1
Execution log at: /tmp/hdp_oc_team/hdp_oc_team_20161220080151_81d33481-d4f6-4132-a9c2-b8ff7ffb526d.log
2016-12-20 08:02:39	Starting to launch local task to process map join;	maximum memory = 2092433408
2016-12-20 08:02:49	Dump the side-table for tag: 1 with group count: 12 into file: file:/tmp/hdp_oc_team/3c5faf97-f09e-4736-a4ad-a08c312ac453/hive_2016-12-20_08-01-51_088_3664093055157359633-1/-local-10005/HashTable-Stage-4/MapJoin-mapfile01--.hashtable
2016-12-20 08:02:50	Uploaded 1 File to: file:/tmp/hdp_oc_team/3c5faf97-f09e-4736-a4ad-a08c312ac453/hive_2016-12-20_08-01-51_088_3664093055157359633-1/-local-10005/HashTable-Stage-4/MapJoin-mapfile01--.hashtable (3885136 bytes)
2016-12-20 08:02:50	Dump the side-table for tag: 1 with group count: 4 into file: file:/tmp/hdp_oc_team/3c5faf97-f09e-4736-a4ad-a08c312ac453/hive_2016-12-20_08-01-51_088_3664093055157359633-1/-local-10005/HashTable-Stage-4/MapJoin-mapfile11--.hashtable
2016-12-20 08:02:50	Uploaded 1 File to: file:/tmp/hdp_oc_team/3c5faf97-f09e-4736-a4ad-a08c312ac453/hive_2016-12-20_08-01-51_088_3664093055157359633-1/-local-10005/HashTable-Stage-4/MapJoin-mapfile11--.hashtable (567 bytes)
2016-12-20 08:02:50	Dump the side-table for tag: 1 with group count: 3 into file: file:/tmp/hdp_oc_team/3c5faf97-f09e-4736-a4ad-a08c312ac453/hive_2016-12-20_08-01-51_088_3664093055157359633-1/-local-10005/HashTable-Stage-4/MapJoin-mapfile21--.hashtable
2016-12-20 08:02:51	Uploaded 1 File to: file:/tmp/hdp_oc_team/3c5faf97-f09e-4736-a4ad-a08c312ac453/hive_2016-12-20_08-01-51_088_3664093055157359633-1/-local-10005/HashTable-Stage-4/MapJoin-mapfile21--.hashtable (693 bytes)
2016-12-20 08:02:51	End of local task; Time Taken: 12.032 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
16/12/20 08:02:55 ERROR mr.ExecDriver: yarn
16/12/20 08:02:57 WARN mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
Starting Job = job_1478649307064_896916, Tracking URL = http://p3plpaname02.prod.phx3.gdg:8088/proxy/application_1478649307064_896916/
Kill Command = /usr/lib/hadoop/bin/hadoop job  -kill job_1478649307064_896916
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 1
16/12/20 08:03:12 WARN mapreduce.Counters: Group org.apache.hadoop.mapred.Task$Counter is deprecated. Use org.apache.hadoop.mapreduce.TaskCounter instead
2016-12-20 08:03:12,073 Stage-4 map = 0%,  reduce = 0%
2016-12-20 08:03:15,381 Stage-4 map = 33%,  reduce = 0%, Cumulative CPU 3.73 sec
2016-12-20 08:03:16,489 Stage-4 map = 67%,  reduce = 0%, Cumulative CPU 9.55 sec
2016-12-20 08:03:19,766 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 15.51 sec
2016-12-20 08:03:25,270 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 25.35 sec
MapReduce Total cumulative CPU time: 25 seconds 350 msec
Ended Job = job_1478649307064_896916
Loading data to table hdp_oc_team.campaign
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/campaign/000000_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Table hdp_oc_team.campaign stats: [numFiles=1, numRows=185246, totalSize=30155290, rawDataSize=29970044]
MapReduce Jobs Launched: 
Stage-Stage-4: Map: 3  Reduce: 1   Cumulative CPU: 25.35 sec   HDFS Read: 66868 HDFS Write: 30155376 SUCCESS
Total MapReduce CPU Time Spent: 25 seconds 350 msec
OK
Time taken: 98.534 seconds
16/12/20 08:04:11 INFO tool.ConnectorExportTool: ConnectorExportTool starts at 1482246251011
16/12/20 08:04:13 INFO common.ConnectorPlugin: load plugins in file:/tmp/hadoop-unjar8213761684351437864/teradata.connector.plugins.xml
16/12/20 08:04:14 INFO processor.TeradataOutputProcessor: output preprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor starts at:  1482246254209
16/12/20 08:04:16 INFO utils.TeradataUtils: the output database product is Teradata
16/12/20 08:05:13 INFO utils.TeradataUtils: the output database version is 15.0
16/12/20 08:05:13 INFO utils.TeradataUtils: the jdbc driver version is 15.0
16/12/20 08:05:14 INFO processor.TeradataOutputProcessor: the teradata connector for hadoop version is: 1.4.2
16/12/20 08:05:14 INFO processor.TeradataOutputProcessor: output jdbc properties are jdbc:teradata://godaddy3.prod.phx3.gdg/DATABASE=P_HadoopImp_S
16/12/20 08:05:20 INFO processor.TeradataBatchInsertProcessor: create output stage table Campaign_STG_080517029the sql is CREATE MULTISET TABLE "Campaign_STG_080517029", DATABLOCKSIZE = 130048 BYTES, NO FALLBACK, NO BEFORE JOURNAL, NO AFTER JOURNAL, CHECKSUM = DEFAULT ("shopper_id" INTEGER NULL, "campaign_id" INTEGER NULL, "campaign_name" VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "audience_id" INTEGER NULL, "audience_description" VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "treatment_id" INTEGER NULL, "treatment_name" VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "inclusion_date" VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "TDCH_BI_TASKID" VARCHAR(40) NOT CASESPECIFIC NULL) NO PRIMARY INDEX  
16/12/20 08:05:20 INFO processor.TeradataOutputProcessor: the number of mappers are 144
16/12/20 08:05:20 INFO processor.TeradataOutputProcessor: output preprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor ends at:  1482246320950
16/12/20 08:05:20 INFO processor.TeradataOutputProcessor: the total elapsed time of output preprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor is: 66s
16/12/20 08:05:26 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 20997965 for hdp_oc_team on ha-hdfs:production
16/12/20 08:05:26 INFO security.TokenCache: Got dt for hdfs://production; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:production, Ident: (HDFS_DELEGATION_TOKEN token 20997965 for hdp_oc_team)
16/12/20 08:05:27 INFO input.FileInputFormat: Total input paths to process : 1
16/12/20 08:05:27 INFO input.FileInputFormat: Total input paths to process : 1
16/12/20 08:05:27 INFO input.CombineFileInputFormat: DEBUG: Terminated node allocation with : CompletedNodes: 1, size left: 0
16/12/20 08:05:27 INFO mapreduce.JobSubmitter: number of splits:144
16/12/20 08:05:28 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1478649307064_897010
16/12/20 08:05:28 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:production, Ident: (HDFS_DELEGATION_TOKEN token 20997965 for hdp_oc_team)
16/12/20 08:05:28 INFO impl.YarnClientImpl: Submitted application application_1478649307064_897010
16/12/20 08:05:28 INFO mapreduce.Job: The url to track the job: http://p3plpaname02.prod.phx3.gdg:8088/proxy/application_1478649307064_897010/
16/12/20 08:05:28 INFO mapreduce.Job: Running job: job_1478649307064_897010
16/12/20 08:05:37 INFO mapreduce.Job: Job job_1478649307064_897010 running in uber mode : false
16/12/20 08:05:37 INFO mapreduce.Job:  map 0% reduce 0%
16/12/20 08:05:45 INFO mapreduce.Job:  map 1% reduce 0%
16/12/20 08:05:46 INFO mapreduce.Job:  map 6% reduce 0%
16/12/20 08:05:48 INFO mapreduce.Job:  map 10% reduce 0%
16/12/20 08:05:49 INFO mapreduce.Job:  map 16% reduce 0%
16/12/20 08:05:50 INFO mapreduce.Job:  map 30% reduce 0%
16/12/20 08:05:51 INFO mapreduce.Job:  map 40% reduce 0%
16/12/20 08:05:52 INFO mapreduce.Job:  map 48% reduce 0%
16/12/20 08:05:53 INFO mapreduce.Job:  map 63% reduce 0%
16/12/20 08:05:54 INFO mapreduce.Job:  map 74% reduce 0%
16/12/20 08:05:55 INFO mapreduce.Job:  map 86% reduce 0%
16/12/20 08:05:56 INFO mapreduce.Job:  map 94% reduce 0%
16/12/20 08:05:57 INFO mapreduce.Job:  map 99% reduce 0%
16/12/20 08:05:58 INFO mapreduce.Job:  map 100% reduce 0%
16/12/20 08:05:59 INFO mapreduce.Job: Job job_1478649307064_897010 completed successfully
16/12/20 08:05:59 INFO mapreduce.Job: Counters: 32
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=20300334
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=37793389
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=289
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Job Counters 
		Launched map tasks=144
		Other local map tasks=123
		Data-local map tasks=1
		Rack-local map tasks=20
		Total time spent by all maps in occupied slots (ms)=3020534
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=1510267
		Total vcore-milliseconds taken by all map tasks=1510267
		Total megabyte-milliseconds taken by all map tasks=6186053632
	Map-Reduce Framework
		Map input records=185246
		Map output records=185246
		Input split bytes=22980
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=19009
		CPU time spent (ms)=755250
		Physical memory (bytes) snapshot=52192911360
		Virtual memory (bytes) snapshot=604530085888
		Total committed heap usage (bytes)=60500213760
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=0
16/12/20 08:05:59 INFO processor.TeradataOutputProcessor: output postprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor starts at:  1482246359548
16/12/20 08:06:00 INFO processor.TeradataBatchInsertProcessor: insert from staget table to target table 
16/12/20 08:06:00 INFO processor.TeradataBatchInsertProcessor: the insert select sql starts at: 1482246360401
16/12/20 08:06:07 INFO processor.TeradataBatchInsertProcessor: the insert select sql ends at: 1482246367052
16/12/20 08:06:07 INFO processor.TeradataBatchInsertProcessor: the total elapsed time of the insert select sql  is: 6s
16/12/20 08:06:13 INFO processor.TeradataBatchInsertProcessor: drop stage table "Campaign_STG_080517029"
16/12/20 08:06:13 INFO processor.TeradataOutputProcessor: output postprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor ends at:  1482246359548
16/12/20 08:06:13 INFO processor.TeradataOutputProcessor: the total elapsed time of output postprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor is: 14s
16/12/20 08:06:13 INFO tool.ConnectorExportTool: ConnectorExportTool ends at 1482246373867
16/12/20 08:06:13 INFO tool.ConnectorExportTool: ConnectorExportTool time is 122s
16/12/20 08:06:13 INFO tool.ConnectorExportTool: job completed with exit code 0
BTEQ 15.00.00.02 Tue Dec 20 08:06:14 2016 PID: 28431
 
+---------+---------+---------+---------+---------+---------+---------+----
.SET ECHOREQ ON
+---------+---------+---------+---------+---------+---------+---------+----
.SET ERROROUT STDOUT
 *** Error messages now directed to STDOUT.
+---------+---------+---------+---------+---------+---------+---------+----
.SET WIDTH 256
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


.LOGON godaddy3.prod.phx3.gdg/P_BTCH_HadoopImp,

 *** Logon successfully completed.
 *** Teradata Database Release is 15.00.02.03                   
 *** Teradata Database Version is 15.00.02.05                     
 *** Transaction Semantics are BTET.
 *** Session Character Set Name is 'ASCII'.
 
 *** Total elapsed time was 1 second.
 
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

SELECT TOP 1 * FROM P_HadoopImp_S.Campaign_STG;

 *** Query completed. One row found. 8 columns returned. 
 *** Total elapsed time was 1 second.

 shopper_id campaign_id campaign_name                                                                                        audience_id audience_description                                                                                 treatment_id treat
----------- ----------- ---------------------------------------------------------------------------------------------------- ----------- ---------------------------------------------------------------------------------------------------- ------------ -----
   55452512           3 SSL Cross-Sell: Shopping cart but no SSL (DataProvider) campaign                                               2 Shopping cart, no SSL customers, email opt ins, US and CA                                                       1 Treat

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ACTIVITYCOUNT = 0 THEN .GOTO E086
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DELETE P_ARM_IMPORT.Campaign ALL;

 *** Delete completed. 185246 rows removed. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO E003
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

INSERT INTO P_ARM_IMPORT.Campaign 
SELECT *
FROM P_HadoopImp_S.Campaign_STG;

 *** Insert completed. 185246 rows added. 
 *** Total elapsed time was 2 seconds.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO E003
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

COLLECT STATS P_ARM_IMPORT.Campaign COLUMN(shopper_id, campaign_id);

 *** Update completed. 2 rows changed. 
 *** Total elapsed time was 18 seconds.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO E003
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DELETE P_HADOOPIMP_S.Campaign_STG ALL;

 *** Delete completed. 185246 rows removed. 
 *** Total elapsed time was 9 seconds.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO E003
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

------------------------------------------------------------------------
--  086 - Good exit
------------------------------------------------------------------------

.LABEL E086
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.LOGOFF
 *** You are now logged off from the DBC.
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.QUIT
 *** Exiting BTEQ...
 *** RC (return code) = 0 
