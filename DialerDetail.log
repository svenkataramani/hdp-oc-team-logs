
Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
OK
Time taken: 1.839 seconds
Query ID = hdp_oc_team_20161220010118_ba3a2aff-a839-4dd3-8895-6618268c4998
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 12
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
16/12/20 01:01:19 ERROR mr.ExecDriver: yarn
16/12/20 01:01:20 WARN mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
Starting Job = job_1478649307064_886919, Tracking URL = http://p3plpaname02.prod.phx3.gdg:8088/proxy/application_1478649307064_886919/
Kill Command = /usr/lib/hadoop/bin/hadoop job  -kill job_1478649307064_886919
Hadoop job information for Stage-1: number of mappers: 195; number of reducers: 12
16/12/20 01:01:35 WARN mapreduce.Counters: Group org.apache.hadoop.mapred.Task$Counter is deprecated. Use org.apache.hadoop.mapreduce.TaskCounter instead
2016-12-20 01:01:35,920 Stage-1 map = 0%,  reduce = 0%
2016-12-20 01:01:52,015 Stage-1 map = 1%,  reduce = 0%, Cumulative CPU 5.61 sec
2016-12-20 01:01:53,056 Stage-1 map = 4%,  reduce = 0%, Cumulative CPU 51.3 sec
2016-12-20 01:01:54,088 Stage-1 map = 8%,  reduce = 0%, Cumulative CPU 109.49 sec
2016-12-20 01:01:55,123 Stage-1 map = 17%,  reduce = 0%, Cumulative CPU 397.65 sec
2016-12-20 01:01:56,165 Stage-1 map = 31%,  reduce = 0%, Cumulative CPU 898.43 sec
2016-12-20 01:01:57,212 Stage-1 map = 46%,  reduce = 0%, Cumulative CPU 1448.73 sec
2016-12-20 01:01:58,258 Stage-1 map = 62%,  reduce = 0%, Cumulative CPU 1895.72 sec
2016-12-20 01:01:59,301 Stage-1 map = 75%,  reduce = 0%, Cumulative CPU 2279.14 sec
2016-12-20 01:02:00,336 Stage-1 map = 79%,  reduce = 0%, Cumulative CPU 2372.17 sec
2016-12-20 01:02:01,566 Stage-1 map = 87%,  reduce = 0%, Cumulative CPU 2546.25 sec
2016-12-20 01:02:02,595 Stage-1 map = 92%,  reduce = 0%, Cumulative CPU 2629.45 sec
2016-12-20 01:02:03,636 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 2703.03 sec
2016-12-20 01:02:05,716 Stage-1 map = 95%,  reduce = 0%, Cumulative CPU 2750.59 sec
2016-12-20 01:02:07,785 Stage-1 map = 96%,  reduce = 3%, Cumulative CPU 2787.56 sec
2016-12-20 01:02:08,819 Stage-1 map = 96%,  reduce = 24%, Cumulative CPU 2812.48 sec
2016-12-20 01:02:09,852 Stage-1 map = 96%,  reduce = 32%, Cumulative CPU 2830.66 sec
2016-12-20 01:02:13,997 Stage-1 map = 97%,  reduce = 32%, Cumulative CPU 2858.49 sec
2016-12-20 01:02:36,941 Stage-1 map = 98%,  reduce = 32%, Cumulative CPU 3040.7 sec
2016-12-20 01:02:39,007 Stage-1 map = 98%,  reduce = 33%, Cumulative CPU 3051.07 sec
2016-12-20 01:02:41,081 Stage-1 map = 99%,  reduce = 33%, Cumulative CPU 3060.5 sec
2016-12-20 01:02:52,647 Stage-1 map = 100%,  reduce = 33%, Cumulative CPU 3085.52 sec
2016-12-20 01:02:53,681 Stage-1 map = 100%,  reduce = 36%, Cumulative CPU 3086.62 sec
2016-12-20 01:02:54,719 Stage-1 map = 100%,  reduce = 54%, Cumulative CPU 3098.13 sec
2016-12-20 01:02:55,782 Stage-1 map = 100%,  reduce = 62%, Cumulative CPU 3107.03 sec
2016-12-20 01:02:56,815 Stage-1 map = 100%,  reduce = 66%, Cumulative CPU 3124.39 sec
2016-12-20 01:02:57,871 Stage-1 map = 100%,  reduce = 77%, Cumulative CPU 3195.13 sec
2016-12-20 01:02:58,914 Stage-1 map = 100%,  reduce = 79%, Cumulative CPU 3213.5 sec
2016-12-20 01:02:59,948 Stage-1 map = 100%,  reduce = 87%, Cumulative CPU 3234.48 sec
2016-12-20 01:03:00,991 Stage-1 map = 100%,  reduce = 96%, Cumulative CPU 3259.93 sec
2016-12-20 01:03:02,025 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 3271.05 sec
2016-12-20 01:03:03,063 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 3273.47 sec
MapReduce Total cumulative CPU time: 54 minutes 33 seconds 470 msec
Ended Job = job_1478649307064_886919
Loading data to table hdp_oc_team.dialer_detail
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000000_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000001_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000002_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000003_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000004_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000005_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000006_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000007_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000008_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000009_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000010_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Moved: 'hdfs://production/user/hdp_oc_team/hdp_oc_team.db/dialer_detail/000011_0' to trash at: hdfs://production/user/hdp_oc_team/.Trash/Current
Table hdp_oc_team.dialer_detail stats: [numFiles=12, numRows=3750677, totalSize=1508186383, rawDataSize=1504435706]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 195  Reduce: 12   Cumulative CPU: 3273.47 sec   HDFS Read: 2495436927 HDFS Write: 1508187487 SUCCESS
Total MapReduce CPU Time Spent: 54 minutes 33 seconds 470 msec
OK
Time taken: 107.421 seconds
16/12/20 01:03:06 INFO tool.ConnectorExportTool: ConnectorExportTool starts at 1482220986487
16/12/20 01:03:07 INFO common.ConnectorPlugin: load plugins in file:/tmp/hadoop-unjar165406682424901293/teradata.connector.plugins.xml
16/12/20 01:03:07 INFO processor.TeradataOutputProcessor: output preprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor starts at:  1482220987491
16/12/20 01:03:08 INFO utils.TeradataUtils: the output database product is Teradata
16/12/20 01:03:08 INFO utils.TeradataUtils: the output database version is 15.0
16/12/20 01:03:08 INFO utils.TeradataUtils: the jdbc driver version is 15.0
16/12/20 01:03:08 INFO processor.TeradataOutputProcessor: the teradata connector for hadoop version is: 1.4.2
16/12/20 01:03:08 INFO processor.TeradataOutputProcessor: output jdbc properties are jdbc:teradata://godaddy3.prod.phx3.gdg/DATABASE=P_HadoopImp_S
16/12/20 01:03:09 INFO processor.TeradataBatchInsertProcessor: create output stage table DialerDetail_STG_010308827the sql is CREATE MULTISET TABLE "DialerDetail_STG_010308827", DATABLOCKSIZE = 130048 BYTES, NO FALLBACK, NO BEFORE JOURNAL, NO AFTER JOURNAL, CHECKSUM = DEFAULT ("recoverykey" DOUBLE PRECISION NULL, "datetime" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "timezone" INTEGER NULL, "customertimezone" INTEGER NULL, "dbdatetime" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "campaignid" INTEGER NULL, "callresult" INTEGER NULL, "callresultdetail" INTEGER NULL, "callstatuszone1" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "callstatuszone2" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "queryruleid" INTEGER NULL, "dialinglistid" INTEGER NULL, "phone" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "phoneext" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "skillgroupskilltargetid" INTEGER NULL, "phoneindex" INTEGER NULL, "phoneid" INTEGER NULL, "zoneindex" INTEGER NULL, "agentperipheralnumber" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "peripheralid" INTEGER NULL, "peripheralcallkey" INTEGER NULL, "callduration" INTEGER NULL, "accountnumber" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "firstname" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "lastname" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "callbackphone" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "callbackdatetime" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "dialingmode" INTEGER NULL, "dialerid" INTEGER NULL, "portnumber" INTEGER NULL, "importruledatetime" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "internaluse1" INTEGER NULL, "internaluse2" INTEGER NULL, "internaluse3" INTEGER NULL, "internaluse4" INTEGER NULL, "internaluse5" INTEGER NULL, "internaluse6" INTEGER NULL, "internaluse7" INTEGER NULL, "internaluse8" INTEGER NULL, "internaluse9" INTEGER NULL, "internaluse10" INTEGER NULL, "internaluse11" INTEGER NULL, "futureuseint1" INTEGER NULL, "futureuseint2" INTEGER NULL, "futureuseint3" INTEGER NULL, "futureuseint4" INTEGER NULL, "futureuseint5" INTEGER NULL, "futureuseint6" INTEGER NULL, "futureuseint7" INTEGER NULL, "futureuseint8" INTEGER NULL, "futureusevarchar1" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "futureusevarchar2" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "futureusevarchar3" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "futureusevarchar4" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "routercallkey" INTEGER NULL, "callguid" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "routercallkeyday" INTEGER NULL, "wrapupdata" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "pickuptime" INTEGER NULL, "maxactiveglitchtime" INTEGER NULL, "numofactiveglitches" INTEGER NULL, "validspeechtime" INTEGER NULL, "maxpostspeechsilenceglitchtime" INTEGER NULL, "numofpostspeechsilenceglitches" INTEGER NULL, "silenceperiod" INTEGER NULL, "termtonedetectiontime" INTEGER NULL, "maxzcrstdev" INTEGER NULL, "noisethreshold" INTEGER NULL, "activethreshold" INTEGER NULL, "reservationcallduration" INTEGER NULL, "previewtime" INTEGER NULL, "campaignreportingdatetime" VARCHAR(128) CHARACTER SET LATIN NOT CASESPECIFIC NULL, "protocolid" INTEGER NULL, "TDCH_BI_TASKID" VARCHAR(40) NOT CASESPECIFIC NULL) NO PRIMARY INDEX  
16/12/20 01:03:09 INFO processor.TeradataOutputProcessor: the number of mappers are 144
16/12/20 01:03:09 INFO processor.TeradataOutputProcessor: output preprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor ends at:  1482220989047
16/12/20 01:03:09 INFO processor.TeradataOutputProcessor: the total elapsed time of output preprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor is: 1s
16/12/20 01:03:10 INFO hdfs.DFSClient: Created HDFS_DELEGATION_TOKEN token 20986833 for hdp_oc_team on ha-hdfs:production
16/12/20 01:03:10 INFO security.TokenCache: Got dt for hdfs://production; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:production, Ident: (HDFS_DELEGATION_TOKEN token 20986833 for hdp_oc_team)
16/12/20 01:03:11 INFO input.FileInputFormat: Total input paths to process : 12
16/12/20 01:03:11 INFO input.FileInputFormat: Total input paths to process : 12
16/12/20 01:03:11 INFO input.CombineFileInputFormat: DEBUG: Terminated node allocation with : CompletedNodes: 33, size left: 0
16/12/20 01:03:11 INFO mapreduce.JobSubmitter: number of splits:139
16/12/20 01:03:11 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1478649307064_887011
16/12/20 01:03:11 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:production, Ident: (HDFS_DELEGATION_TOKEN token 20986833 for hdp_oc_team)
16/12/20 01:03:11 INFO impl.YarnClientImpl: Submitted application application_1478649307064_887011
16/12/20 01:03:11 INFO mapreduce.Job: The url to track the job: http://p3plpaname02.prod.phx3.gdg:8088/proxy/application_1478649307064_887011/
16/12/20 01:03:11 INFO mapreduce.Job: Running job: job_1478649307064_887011
16/12/20 01:03:23 INFO mapreduce.Job: Job job_1478649307064_887011 running in uber mode : false
16/12/20 01:03:23 INFO mapreduce.Job:  map 0% reduce 0%
16/12/20 01:03:36 INFO mapreduce.Job:  map 5% reduce 0%
16/12/20 01:03:37 INFO mapreduce.Job:  map 10% reduce 0%
16/12/20 01:03:38 INFO mapreduce.Job:  map 27% reduce 0%
16/12/20 01:03:39 INFO mapreduce.Job:  map 43% reduce 0%
16/12/20 01:03:40 INFO mapreduce.Job:  map 58% reduce 0%
16/12/20 01:03:41 INFO mapreduce.Job:  map 70% reduce 0%
16/12/20 01:03:42 INFO mapreduce.Job:  map 77% reduce 0%
16/12/20 01:03:43 INFO mapreduce.Job:  map 80% reduce 0%
16/12/20 01:03:44 INFO mapreduce.Job:  map 89% reduce 0%
16/12/20 01:03:45 INFO mapreduce.Job:  map 93% reduce 0%
16/12/20 01:03:46 INFO mapreduce.Job:  map 96% reduce 0%
16/12/20 01:03:47 INFO mapreduce.Job:  map 99% reduce 0%
16/12/20 01:03:53 INFO mapreduce.Job:  map 100% reduce 0%
16/12/20 01:03:53 INFO mapreduce.Job: Job job_1478649307064_887011 completed successfully
16/12/20 01:03:53 INFO mapreduce.Job: Counters: 32
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=21316513
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1510492203
		HDFS: Number of bytes written=0
		HDFS: Number of read operations=290
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=0
	Job Counters 
		Launched map tasks=139
		Other local map tasks=38
		Data-local map tasks=15
		Rack-local map tasks=86
		Total time spent by all maps in occupied slots (ms)=4021524
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=2010762
		Total vcore-milliseconds taken by all map tasks=2010762
		Total megabyte-milliseconds taken by all map tasks=8236081152
	Map-Reduce Framework
		Map input records=3750677
		Map output records=3750677
		Input split bytes=23864
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=38212
		CPU time spent (ms)=1534740
		Physical memory (bytes) snapshot=66258771968
		Virtual memory (bytes) snapshot=584671391744
		Total committed heap usage (bytes)=55880187904
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=0
16/12/20 01:03:53 INFO processor.TeradataOutputProcessor: output postprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor starts at:  1482221033538
16/12/20 01:03:53 INFO processor.TeradataBatchInsertProcessor: insert from staget table to target table 
16/12/20 01:03:53 INFO processor.TeradataBatchInsertProcessor: the insert select sql starts at: 1482221033657
16/12/20 01:03:54 INFO processor.TeradataBatchInsertProcessor: the insert select sql ends at: 1482221034837
16/12/20 01:03:54 INFO processor.TeradataBatchInsertProcessor: the total elapsed time of the insert select sql  is: 1s
16/12/20 01:03:55 INFO processor.TeradataBatchInsertProcessor: drop stage table "DialerDetail_STG_010308827"
16/12/20 01:03:55 INFO processor.TeradataOutputProcessor: output postprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor ends at:  1482221033538
16/12/20 01:03:55 INFO processor.TeradataOutputProcessor: the total elapsed time of output postprocessor com.teradata.connector.teradata.processor.TeradataBatchInsertProcessor is: 1s
16/12/20 01:03:55 INFO tool.ConnectorExportTool: ConnectorExportTool ends at 1482221035100
16/12/20 01:03:55 INFO tool.ConnectorExportTool: ConnectorExportTool time is 48s
16/12/20 01:03:55 INFO tool.ConnectorExportTool: job completed with exit code 0
BTEQ 15.00.00.02 Tue Dec 20 01:03:55 2016 PID: 10250
 
+---------+---------+---------+---------+---------+---------+---------+----
/************************************************************************ 
**
**        NAME:  vsDialerDetail-Daily.btq
**
**      INPUTS:  P_HadoopImp.vsDialerDetail_STG
**
**     OUTPUTS:  P_HadoopImp.vtDialerDetail
**               P_HadoopImp.DialerDetail
**
**    PROCESS OVERVIEW:
**       1. Inset new recods
**       2. Recods will never change, so no updates
**       3. Delete older records that are out of range
**
**
**     HISTORY:  AUTHOR    	        DATE                DESCRIPTION
**               MPENNY	      	2015-06-18             Original script
************************************************************************/

.SET ECHOREQ ON
+---------+---------+---------+---------+---------+---------+---------+----
.SET ERROROUT STDOUT
 *** Error messages now directed to STDOUT.
+---------+---------+---------+---------+---------+---------+---------+----
.SET WIDTH 256
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


.LOGON godaddy3.prod.phx3.gdg/P_BTCH_HadoopImp,

 *** Logon successfully completed.
 *** Teradata Database Release is 15.00.02.03                   
 *** Teradata Database Version is 15.00.02.05                     
 *** Transaction Semantics are BTET.
 *** Session Character Set Name is 'ASCII'.
 
 *** Total elapsed time was 1 second.
 
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

------------------------------------------------------------------------
-- 001 - Check for data in staging
------------------------------------------------------------------------
SELECT TOP 1 * FROM P_HadoopImp.vsDialerDetail_STG;

 *** Query completed. One row found. 73 columns returned. 
 *** Total elapsed time was 1 second.

           recoverykey datetime                                                                                                                            timezone customertimezone dbdatetime
---------------------- -------------------------------------------------------------------------------------------------------------------------------- ----------- ---------------- ---------------------------------------------------------------------------
 7.99403864512200E 012 2016-12-09 10:36:54.793                                                                                                                  420              360 2016-12-09 10:38:20.663

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ACTIVITYCOUNT = 0 THEN .GOTO E003;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


------------------------------------------------------------------------
--  002 - Insert new records
------------------------------------------------------------------------

INSERT P_HadoopImp_T.DialerDetail
(  
     recoverykey
    ,datetime
    ,timezone
    ,customertimezone
    ,dbdatetime
    ,campaignid
    ,callresult
    ,callresultdetail
    ,callstatuszone1
    ,callstatuszone2
    ,queryruleid
    ,dialinglistid
    ,phone
    ,phoneext
    ,skillgroupskilltargetid
    ,phoneindex
    ,phoneid
    ,zoneindex
    ,agentperipheralnumber
    ,peripheralid
    ,peripheralcallkey
    ,callduration
    ,accountnumber
    ,firstname
    ,lastname
    ,callbackphone
    ,callbackdatetime
    ,dialingmode
    ,dialerid
    ,portnumber
    ,importruledatetime
    ,internaluse1
    ,internaluse2
    ,internaluse3
    ,internaluse4
    ,internaluse5
    ,internaluse6
    ,internaluse7
    ,internaluse8
    ,internaluse9
    ,internaluse10
    ,internaluse11
    ,futureuseint1
    ,futureuseint2
    ,futureuseint3
    ,futureuseint4
    ,futureuseint5
    ,futureuseint6
    ,futureuseint7
    ,futureuseint8
    ,futureusevarchar1
    ,futureusevarchar2
    ,futureusevarchar3
    ,futureusevarchar4
    ,routercallkey
    ,callguid
    ,routercallkeyday
    ,wrapupdata
    ,pickuptime
    ,maxactiveglitchtime
    ,numofactiveglitches
    ,validspeechtime
    ,maxpostspeechsilenceglitchtime
    ,numofpostspeechsilenceglitches
    ,silenceperiod
    ,termtonedetectiontime
    ,maxzcrstdev
    ,noisethreshold
    ,activethreshold
    ,reservationcallduration
    ,previewtime
    ,campaignreportingdatetime
    ,protocolid
    ,DelInd
    ,EtlInsLdId
    ,EtlUpdLdId
 )
SELECT   STG.recoverykey
        ,STG.datetime
        ,STG.timezone
        ,STG.customertimezone
        ,STG.dbdatetime
        ,STG.campaignid
        ,STG.callresult
        ,STG.callresultdetail
        ,STG.callstatuszone1
        ,STG.callstatuszone2
        ,STG.queryruleid
        ,STG.dialinglistid
        ,STG.phone
        ,STG.phoneext
        ,STG.skillgroupskilltargetid
        ,STG.phoneindex
        ,STG.phoneid
        ,STG.zoneindex
        ,STG.agentperipheralnumber
        ,STG.peripheralid
        ,STG.peripheralcallkey
        ,STG.callduration
        ,STG.accountnumber
        ,STG.firstname
        ,STG.lastname
        ,STG.callbackphone
        ,STG.callbackdatetime
        ,STG.dialingmode
        ,STG.dialerid
        ,STG.portnumber
        ,STG.importruledatetime
        ,STG.internaluse1
        ,STG.internaluse2
        ,STG.internaluse3
        ,STG.internaluse4
        ,STG.internaluse5
        ,STG.internaluse6
        ,STG.internaluse7
        ,STG.internaluse8
        ,STG.internaluse9
        ,STG.internaluse10
        ,STG.internaluse11
        ,STG.futureuseint1
        ,STG.futureuseint2
        ,STG.futureuseint3
        ,STG.futureuseint4
        ,STG.futureuseint5
        ,STG.futureuseint6
        ,STG.futureuseint7
        ,STG.futureuseint8
        ,STG.futureusevarchar1
        ,STG.futureusevarchar2
        ,STG.futureusevarchar3
        ,STG.futureusevarchar4
        ,STG.routercallkey
        ,STG.callguid
        ,STG.routercallkeyday
        ,STG.wrapupdata
        ,STG.pickuptime
        ,STG.maxactiveglitchtime
        ,STG.numofactiveglitches
        ,STG.validspeechtime
        ,STG.maxpostspeechsilenceglitchtime
        ,STG.numofpostspeechsilenceglitches
        ,STG.silenceperiod
        ,STG.termtonedetectiontime
        ,STG.maxzcrstdev
        ,STG.noisethreshold
        ,STG.activethreshold
        ,STG.reservationcallduration
        ,STG.previewtime
        ,STG.campaignreportingdatetime
        ,STG.protocolid
        ,CAST('A' AS CHAR(1)) AS DelInd
        ,CAST(0 AS INTEGER) AS EtlInsLdId
        ,CAST(0 AS INTEGER) AS EtlUpdLdId
FROM    P_HadoopImp.vsDialerDetail_STG AS STG
LEFT JOIN   P_HadoopImp.vtDialerDetail AS TRG
ON      STG.recoverykey = TRG.recoverykey       
WHERE   TRG.recoverykey IS NULL;

 *** Insert completed. 65175 rows added. 
 *** Total elapsed time was 2 seconds.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


.IF ERRORCODE <> 0 THEN .GOTO E003
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


------------------------------------------------------------------------
--  003 - Remove recods that are out of range
------------------------------------------------------------------------

DELETE FROM 
P_HadoopImp_T.DialerDetail
WHERE dbDateTime < CAST( ( DATE - 60 ) AS VARCHAR(128) );

 *** Delete completed. 138481 rows removed. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO E003
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


------------------------------------------------------------------------
--  004 - Flush staging table for next time
------------------------------------------------------------------------
/* GOTO Redirect From Section 002A */
.LABEL S003
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DELETE P_HadoopImp.vsDialerDetail_STG;

 *** Delete completed. 3750677 rows removed. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO E003
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.LOGOFF
 *** You are now logged off from the DBC.
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.QUIT
 *** Exiting BTEQ...
 *** RC (return code) = 0 
